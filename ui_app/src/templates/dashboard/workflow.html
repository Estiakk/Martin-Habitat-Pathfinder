{% extends "layout.html" %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0"><i class="bi bi-diagram-3"></i> Complete Workflow Visualization</h5>
            </div>
            <div class="card-body">
                <div class="workflow-diagram text-center">
                    <img src="{{ url_for('serve_static', filename='img/workflow_detailed.png') }}" alt="Detailed Workflow Diagram" class="img-fluid" onerror="this.src='https://via.placeholder.com/1200x600?text=Detailed+Workflow+Diagram'">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="card-title mb-0"><i class="bi bi-list-check"></i> Data Processing Workflow</h5>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <a href="{{ url_for('pdf.index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">1. Upload PDF Documents</h5>
                            <p class="mb-1">Upload scientific papers and technical documents about Mars habitats</p>
                        </div>
                        <span class="badge bg-primary rounded-pill">Step 1</span>
                    </a>
                    <a href="{{ url_for('pdf.process_all_pdfs') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" onclick="event.preventDefault(); document.getElementById('process-all-form').submit();">
                        <div>
                            <h5 class="mb-1">2. Process PDF Documents</h5>
                            <p class="mb-1">Extract scientific data and parameters from PDFs</p>
                        </div>
                        <span class="badge bg-primary rounded-pill">Step 2</span>
                    </a>
                    <form id="process-all-form" action="{{ url_for('pdf.process_all_pdfs') }}" method="post" style="display: none;"></form>
                    <a href="{{ url_for('data.index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">3. Manage NASA Data</h5>
                            <p class="mb-1">Fetch and process data from NASA sources</p>
                        </div>
                        <span class="badge bg-primary rounded-pill">Step 3</span>
                    </a>
                    <a href="{{ url_for('data.run_pipeline') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" onclick="event.preventDefault(); document.getElementById('run-pipeline-form').submit();">
                        <div>
                            <h5 class="mb-1">4. Run Data Pipeline</h5>
                            <p class="mb-1">Combine all data sources and prepare for simulation</p>
                        </div>
                        <span class="badge bg-primary rounded-pill">Step 4</span>
                    </a>
                    <form id="run-pipeline-form" action="{{ url_for('data.run_pipeline') }}" method="post" style="display: none;"></form>
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0"><i class="bi bi-robot"></i> AI & Simulation Workflow</h5>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <a href="{{ url_for('pdf.prepare_training_data') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" onclick="event.preventDefault(); document.getElementById('prepare-training-form').submit();">
                        <div>
                            <h5 class="mb-1">1. Prepare Training Data</h5>
                            <p class="mb-1">Convert processed data into training format for LLMs</p>
                        </div>
                        <span class="badge bg-info rounded-pill">Step 1</span>
                    </a>
                    <form id="prepare-training-form" action="{{ url_for('pdf.prepare_training_data') }}" method="post" style="display: none;"></form>
                    <a href="{{ url_for('ollama.index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">2. Configure Ollama LLMs</h5>
                            <p class="mb-1">Pull models and fine-tune with Mars habitat data</p>
                        </div>
                        <span class="badge bg-info rounded-pill">Step 2</span>
                    </a>
                    <a href="{{ url_for('pdf.prepare_simulation_data') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" onclick="event.preventDefault(); document.getElementById('prepare-simulation-form').submit();">
                        <div>
                            <h5 class="mb-1">3. Prepare Simulation Data</h5>
                            <p class="mb-1">Configure simulation parameters from processed data</p>
                        </div>
                        <span class="badge bg-info rounded-pill">Step 3</span>
                    </a>
                    <form id="prepare-simulation-form" action="{{ url_for('pdf.prepare_simulation_data') }}" method="post" style="display: none;"></form>
                    <a href="{{ url_for('simulation.index') }}" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-1">4. Run Simulation</h5>
                            <p class="mb-1">Execute Mars habitat simulation with AI decision-making</p>
                        </div>
                        <span class="badge bg-info rounded-pill">Step 4</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header bg-warning text-dark">
                <h5 class="card-title mb-0"><i class="bi bi-lightbulb"></i> Recommended Workflows</h5>
            </div>
            <div class="card-body">
                <div class="accordion" id="workflowAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingOne">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                <strong>Quick Start Workflow</strong> - Get up and running in minutes
                            </button>
                        </h2>
                        <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#workflowAccordion">
                            <div class="accordion-body">
                                <ol>
                                    <li>Upload a PDF document on the <a href="{{ url_for('pdf.index') }}">PDF Management</a> page</li>
                                    <li>Process the PDF automatically (check "Automatically process after upload")</li>
                                    <li>Go to <a href="{{ url_for('simulation.index') }}">Simulation</a> and start a standard simulation</li>
                                    <li>View results and resource trends</li>
                                </ol>
                                <a href="{{ url_for('dashboard.quick_start') }}" class="btn btn-warning">View Quick Start Guide</a>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingTwo">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                <strong>Complete Research Workflow</strong> - For comprehensive analysis
                            </button>
                        </h2>
                        <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" data-bs-parent="#workflowAccordion">
                            <div class="accordion-body">
                                <ol>
                                    <li>Upload multiple PDF documents on the <a href="{{ url_for('pdf.index') }}">PDF Management</a> page</li>
                                    <li>Process all PDFs using the "Process All PDFs" button</li>
                                    <li>Fetch NASA data on the <a href="{{ url_for('data.index') }}">Data Management</a> page</li>
                                    <li>Run the full data pipeline to combine all sources</li>
                                    <li>Prepare training data for Ollama</li>
                                    <li>Configure and fine-tune an LLM on the <a href="{{ url_for('ollama.index') }}">Ollama LLM</a> page</li>
                                    <li>Prepare simulation data</li>
                                    <li>Run a custom simulation with the fine-tuned LLM</li>
                                    <li>Analyze results and export logs</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header" id="headingThree">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                <strong>AI Comparison Workflow</strong> - Compare different AI approaches
                            </button>
                        </h2>
                        <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree" data-bs-parent="#workflowAccordion">
                            <div class="accordion-body">
                                <ol>
                                    <li>Complete the data processing workflow (steps 1-4 above)</li>
                                    <li>Run a simulation with "Reinforcement Learning" AI mode</li>
                                    <li>Export the simulation log</li>
                                    <li>Run the same simulation with "Large Language Model" AI mode</li>
                                    <li>Export the simulation log</li>
                                    <li>Run the same simulation with "Hybrid" AI mode</li>
                                    <li>Compare the results and resource trends across all three approaches</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
